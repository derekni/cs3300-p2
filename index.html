<html>
  <head>
    <meta charset="UTF-8">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      .gridlines line{
        stroke: #bbb
      }
      .gridlines .domain{
        stroke: none
      }
    </style>
  </head>
  <body>
    <h2>Visualizing statisitics of students admitted to Ivy League schools in Class of 2025</h2>
    <h3>Megan Jung (mj374), Derek Ni (dan82), Bhav Patel (bdp64), Josh Lundmark (jel299)</h3>
    <p>Graph 1: pie chart, shows population</p>
    <p>Graph 2: chart of USA, color is acceptance rate, size of dot is school size</p>
    <p id="p1">
      <div id="graph"></div>
      <script>
        async function initialize() {
          const schools = await d3.csv("data/ivy_stats1.csv", d3.autoType);
          console.log(schools)
          const div = d3.select("div");
          div.append("svg")
             .attr("width", "500")
             .attr("height", "400")
             .attr("id", "plot1")

          const svg = d3.select("svg#plot1");
          const width = svg.attr("width");
          const height = svg.attr("height");
          const margin = {top: 70, right: 70, bottom: 50, left: 70};
          const chartWidth = width - margin.left - margin.right;
          const chartHeight = height - margin.top - margin.bottom;

          const title = svg.append("text").text("Number of students admitted to Ivy League schools in 2022").attr("x")

          let chartArea = svg.append("g").attr("id","chart-area")
                          .attr("transform","translate(" + width / 2 + "," + height / 2 + ")");

          var ordScale = d3.scaleOrdinal()
                            .domain(["Brown", "Columbia", "Cornell", "Yale", "Harvard", "Dartmouth", "Penn", "Princeton"])
                            .range(['#4E3629', '#9BCBEB', '#B31B1B', '#00356B', '#A41034', '#046A38', '#011F5B', '#FF671F']);
          
          let totalStudents = 0;
          schools.forEach(d => {
            console.log(d["Expected Number of Students to Enroll"])
          })

          var pie = d3.pie().value(function(d) { 
                return d["Expected Number of Students to Enroll"]; 
            });


          var arc = chartArea.selectAll("arc")
                    .data(pie(schools))
                    .enter();

          const radius = 200;
          var path = d3.arc()
                      .outerRadius(radius)
                      .innerRadius(0);

          var label = d3.arc()
            .outerRadius(radius)
            .innerRadius(0);
            
          arc.append("text")
            .attr("transform", function(d) { 
                      return "translate(" + label.centroid(d) + ")"; 
              })
            .text(function(d) { return d.data["Ivy League Colleges"]; })
            .style("font-family", "arial")
            .style("font-size", 15);

          arc.append("path")
            .attr("d", path)
            .attr("fill", function(d) {
              return ordScale(d.data["Ivy League Colleges"]);
            });
        }
        initialize();
      </script>
    </p>
  </body>
</html>
